/* LOCATION TRACKING SITE UI & BACKEND (no Firebase, memory-based) */

// 1. index.html (Login + Signup page)

<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Login / Signup</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 50px; }
    input, button { margin: 5px; padding: 8px; }
    #error { color: red; }
  </style>
</head>
<body>
  <h1>üìç Location Tracker</h1>  <div>
    <h2>Signup</h2>
    <input id="susername" placeholder="Username" />
    <input id="semail" placeholder="Email" />
    <input id="spassword" placeholder="Password" type="password" />
    <button onclick="signup()">Sign Up</button>
  </div>  <div>
    <h2>Login</h2>
    <input id="lusername" placeholder="Username" />
    <input id="lpassword" placeholder="Password" type="password" />
    <button onclick="login()">Login</button>
  </div>  <div id="error"></div>  <script>
    async function signup() {
      const res = await fetch('/api/signup', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          username: susername.value,
          email: semail.value,
          password: spassword.value
        })
      });
      const txt = await res.text();
      alert(txt);
    }

    async function login() {
      const res = await fetch('/api/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          username: lusername.value,
          password: lpassword.value
        })
      });
      const txt = await res.text();
      if (res.ok) {
        sessionStorage.setItem('user', lusername.value);
        location.href = '/dashboard.html';
      } else {
        error.innerText = txt;
      }
    }
  </script></body>
</html>// 2. dashboard.html

<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>
</head>
<body>
  <h1>Welcome to Dashboard</h1>
  <button onclick="copyLink()">üìé Copy Tracking Link</button>
  <button onclick="viewLocation()">üìç View Tracked Location</button>  <script>
    const user = sessionStorage.getItem('user');
    if (!user) location.href = '/index.html';

    function copyLink() {
      const link = location.origin + '/track.html?user=' + user;
      navigator.clipboard.writeText(link).then(() => alert('Copied ‚úÖ'));
    }

    function viewLocation() {
      location.href = '/track.html?user=' + user;
    }
  </script></body>
</html>// 3. track.html (show location)

<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tracker</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>#map { height: 400px; }</style>
</head>
<body>
  <h2>Tracking Map</h2>
  <div id="map"></div>  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>  <script>
    const user = new URLSearchParams(location.search).get('user');
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(async pos => {
        const { latitude, longitude } = pos.coords;
        await fetch('/api/location', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ user, latitude, longitude })
        });

        showMap(latitude, longitude);
      });
    } else {
      alert('Location not supported');
    }

    async function showMap(lat, lng) {
      const map = L.map('map').setView([lat, lng], 13);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
      L.marker([lat, lng]).addTo(map).bindPopup('You are here').openPopup();
    }
  </script></body>
</html>// 4. /pages/api/signup.js let users = [];

export default function handler(req, res) { if (req.method !== 'POST') return res.status(405).send('Method Not Allowed'); const { username, email, password } = req.body; if (!username || !email || !password) return res.status(400).send('All fields required'); const exists = users.find(u => u.username === username); if (exists) return res.status(400).send('‚ùå Username already exists'); users.push({ username, email, password }); res.send('‚úÖ Signup successful'); }

// 5. /pages/api/login.js export default function handler(req, res) { if (req.method !== 'POST') return res.status(405).send('Method Not Allowed'); const { username, password } = req.body; const user = users.find(u => u.username === username && u.password === password); if (user) res.send('‚úÖ Login successful'); else res.status(401).send('‚ùå Invalid credentials'); }

// 6. /pages/api/location.js let locations = {};

export default function handler(req, res) { if (req.method === 'POST') { const { user, latitude, longitude } = req.body; locations[user] = { latitude, longitude }; res.send('Saved ‚úÖ'); } else if (req.method === 'GET') { const { user } = req.query; if (locations[user]) res.json(locations[user]); else res.status(404).send('Not Found'); } else { res.status(405).send('Method Not Allowed'); } }

